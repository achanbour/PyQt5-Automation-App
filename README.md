# PyQt5-Risk-Indicators-Automation-App

> This software has been developed during my full-time employment as a Python developer in the Operational Risk Management divison of Credit Agricole Corporate and Investment Bank (CA-CIB) London Branch. The full code of this project cannot be made public due to the property and intellectual rights agreement outlined in my employment contract. The documentation provided below, while not exhaustive, offers a comprehensive overview of the program's core architecture. Its purpose is to showcase my initial experience with Graphical User Interface (GUI) development in Python and the principles of event-driven programming.

The Key Risk Indicators (KRI) automation app is a single page desktop app automating three main tasks in the KRI collection process:

1. generating Excel files from the KRI table of the Operational Risk database;
2. sending emails to a list of recipients stored in the Operational Risk database with the files generated in step 1 attached; and
3. updating the KRI table for any responses to the emails sent in step 2.

The automation of each of the above three tasks is described in its corresponding ```.py``` file:

1. ```generate_excel.py``` defines the following methods to generate the KRI Excel reports which are then sent to the recipients in step 2.
   1. ```generate_kri_report()``` is a function which:
      1. reads the KRI table as a pandas dataframe;
      2. applies required filters to the KRI dataframe;
      3. generates an Excel file from the filtered KRI dataframe; and
      4. archives the generated Excel file in a specified folder.
   2. Various helper methods are defined to make sure the folders in which the Excel reports are to be stored exist, and if not, create them during execution. The said helper methods are called in the ```generate_kri_report()```  method.
   3. ```xl_stylisation()``` is a helper method called during the execution of ```generate_kri_report()```. It opens the Excel report generated by ```generate_kri_report()``` and applies various formatting adjustments such as resizing columns and rows based on cell content, and applying color formatting rules to the cells.

2. ```send_emails.py``` defines a single method ```send_automatic_emails()``` for sending automatic emails. This method executes the following steps in order:
   1. reads the mailing list table as a pandas dataframe;
   2. iterates over the Excel reports generated in step 1. For each report it:
      1. filters the mailing list dataframe to identify the corresponding recipient(s);
      2. accesses the email server via the local Outlook app using the ```pywin32``` package and creates a new email message with the Excel report as attachment;
      3. sends the email to the recipient(s) listed in the filtered mailing list dataframe; and
      4. archives the email from the previous step in a specified folder.

3. ```update_db.py``` defines a single method ```update_kri_table()``` for updating the KRI table with the results obtained in the reports returned to the automated emails sent in step 2. This step is executed only after responses have been received and archived in the dedicated folders which is accomplished automatically using an [inbox parser](https://github.com/achanbour/Windows-Outlook-inbox-parser). The ```update_kri_table()``` method executes the following steps in order:
   1. reads each archived report as a pandas dataframe and stores the KRI results in a temporary storage location (Python dictionary);
   2. reads the KRI table from the database as a pandas dataframe; and
   3. writes the KRI results to the KRI table.

![](https://github.com/achanbour/PyQt5-Risk-Indicators-Automation-App/blob/main/PyQt5-Risk-Indicators-Automation-App-Python-Files.png)

The ```gui.py``` file defines the application's graphical structure (also known as the the User Interface (UI)) and invokes functions from ```generate_excel.py```, ```send_emails.py```, ```update_db.py``` in response to specific user-triggered events.

Below are some blueprints of the application's UI:

![](https://github.com/achanbour/PyQt5-Risk-Indicators-Automation-App/blob/main/PyQt5-Risk-Indicators-Automation-App-UI-Windowspng.png)

![](https://github.com/achanbour/PyQt5-Risk-Indicators-Automation-App/blob/main/PyQt5-Risk-Indicators-Automation-App-Error-Popup-Window.png)

The details of the UI design and event flow implementation can be found in the ```gui.py``` file included in this repository.
